webpackJsonp([15],{"./public/javascripts/app/newsletter/newsletter.emailButtonView.js":function(a,b,c){var d,e;d=[c("./public/javascripts/lib/jquery.js"),c("./public/javascripts/lib/js-cookie.js"),c("./public/javascripts/lib/backbone.marionette.js"),c("./public/javascripts/app/account/account.channel.js"),c("./public/javascripts/singleton/CurrentUser.js"),c("./public/javascripts/singleton/CurrentBlog.js"),c("./public/javascripts/view/modal/modal.formBehavior.js"),c("./target/scala-2.11/classes/public/javascripts/templates/closure/no-i18n/tiger/components/newsletter/subscription.js"),c("./target/scala-2.11/classes/public/javascripts/templates/closure/no-i18n/tiger/components/newsletter/subscriptionButton.js")],e=function(a,b,c,d,e,f,g){"use strict";var h=c.ItemView.extend({validationFields:[{name:"email",validators:["required","emailFormat"]}],template:tiger.components.newsletter.subscribeButtonEmail,className:"newsletter-subscribe-wrapper newsletter-btn",tagName:"form",ui:{dismissBtn:".js_close-subscribe",fieldDescription:".js_fielddescription",submitBtn:".js_submit",email:".js_email-address",messages:"[data-reason]",inputBox:"input"},behaviors:{FormBehavior:{resetFields:!0,behaviorClass:g}},events:{"click @ui.dismissBtn":"onDismissBtn"},serializeData:function(){return{blogName:this.options.blogName}},onRender:function(){this.$el.addClass("open")},onDismissBtn:function(){a(".js_dismissable").find(".newsletter-subscribe-wrapper").removeClass("open"),b.set("newsletterDismiss",!0)},submit:function(){var a={blogId:f.id,email:this.ui.email.val()};e.isLoggedIn()&&(a.userId=e.id),d.trigger("newsletterflow:submit",this.model,a)},onModelError:function(a,b){var c=JSON.parse(b.responseText),d=c.meta.error;"INVALID_PARAMETER"===d.code?this.triggerMethod("RenderWarning","alreadysubscribed"):"SALESFORCE_ERROR"===d.code?this.triggerMethod("RenderWarning","salesforce"):this.triggerMethod("RenderWarning","network")}});return h}.apply(b,d),!(void 0!==e&&(a.exports=e))},"./public/javascripts/app/newsletter/newsletter.subscribeView.js":function(a,b,c){var d,e;d=[c("./public/javascripts/lib/jquery.js"),c("./public/javascripts/lib/js-cookie.js"),c("./public/javascripts/lib/backbone.marionette.js"),c("./public/javascripts/app/account/account.channel.js"),c("./public/javascripts/singleton/CurrentUser.js"),c("./target/scala-2.11/classes/public/javascripts/templates/closure/no-i18n/tiger/components/newsletter/subscriptionButton.js")],e=function(a,b,c,d,e){"use strict";var f=c.ItemView.extend({template:tiger.components.newsletter.subscribeButton,className:"newsletter-subscribe-wrapper newsletter-btn",ui:{dismissBtn:".js_close-subscribe",subscribeBtn:".js_newsletter-subscribe"},events:{"click @ui.dismissBtn":"onDismissBtn","click @ui.subscribeBtn":"onSubscribeClick"},serializeData:function(){return{blogName:this.options.blogName}},onRender:function(){this.$el.addClass("open")},onDismissBtn:function(){var c=e.isLoggedIn()?"Logged In":"Logged Out";a(".js_dismissable").find(".newsletter-subscribe-wrapper").removeClass("open"),b.set("newsletterDismiss",!0),window.ga("send","event","Newsletter Stream Page","Box Close",c)},onSubscribeClick:function(a){var b=e.isLoggedIn()?"Logged In":"Logged Out";a.preventDefault(),window.ga("send","event","Newsletter Stream Page","Subscribe Click",b)}});return f}.apply(b,d),!(void 0!==e&&(a.exports=e))},"./public/javascripts/app/newsletter/newsletter.unsubscribeView.js":function(a,b,c){var d,e;d=[c("./public/javascripts/lib/jquery.js"),c("./public/javascripts/lib/backbone.marionette.js"),c("./public/javascripts/singleton/CurrentUser.js"),c("./public/javascripts/singleton/CurrentBlog.js"),c("./target/scala-2.11/classes/public/javascripts/templates/closure/no-i18n/tiger/components/newsletter/subscriptionButton.js")],e=function(a,b,c,d){"use strict";var e=b.ItemView.extend({template:tiger.components.newsletter.unsubscribe,className:"newsletter-unsubscribe newsletter-btn",events:{click:"onUnsubscribeClicked"},serializeData:function(){return{blogName:this.options.blogName}},onUnsubscribeClicked:function(a){var b=a.target.getAttribute("href");a.preventDefault(),c.token().done(function(a){var c={token:a,blogId:d.id,redirect:window.location.href};window.location=this.generateUrl(b,c)}.bind(this)).fail(function(){throw new Error("Cannot get token for user")})},generateUrl:function(b,c){var d=b.indexOf("?")>0?"&":"?";return b+d+a.param(c)}});return e}.apply(b,d),!(void 0!==e&&(a.exports=e))},"./public/javascripts/module/SubscriptionModule.js":function(a,b,c){var d,e;d=[c("./public/javascripts/lib/underscore.js"),c("./public/javascripts/lib/js-cookie.js"),c("./public/javascripts/app/MarionetteApp.js"),c("./public/javascripts/app/newsletter/newsletter.subscribeView.js"),c("./public/javascripts/app/newsletter/newsletter.emailButtonView.js"),c("./public/javascripts/app/newsletter/newsletter.unsubscribeView.js"),c("./public/javascripts/model/newsletter.email.model.js"),c("./public/javascripts/singleton/CurrentBlog.js"),c("./public/javascripts/singleton/CurrentUser.js"),c("./public/javascripts/singleton/Feature.js"),c("./public/javascripts/app/account/account.channel.js")],e=function(a,b,d,e,f,g,h,i,j,k,l){"use strict";var m={start:function(){var a=!!i.properties&&!!i.properties.newsletter;a&&(j.isLoggedIn()||m.updateBtnState(),j.onLoggedIn.done(function(){m.updateBtnState()}))},updateBtnState:function(){var c=!!b.get("newsletterDismiss"),e=!!j.get("confirmedEmail"),f=a.contains(j.get("blogSubscriptions"),i.id.toString()),g=i.displayName?i.displayName:"";d.subscribeBtnSidebarRegion.reset(),d.subscribeBtnInstreamRegion.reset(),d.subscribeBtnFooterRegion.reset(),e&&f?this.showUnSubscriptionBtn(g):c?this.showSubscriptionBtn(g,!0):this.showSubscriptionBtn(g)},showSubscriptionBtn:function(a,b){var c=[d.subscribeBtnFooterRegion];l.on("newsletterflow:submit",this.submitEmail),b||c.push(d.subscribeBtnSidebarRegion,d.subscribeBtnInstreamRegion),c.map(function(b){b.show(new f({blogName:a,model:new h}))})},showUnSubscriptionBtn:function(a){var b=new g({blogName:a});d.subscribeBtnFooterRegion.show(b)},submitEmail:function(a,b){var d=i.properties,e=b.email,f;d.salesforceClientId&&d.salesforceExternalKey&&(f={clientId:d.salesforceClientId,externalKey:d.salesforceExternalKey,email:e}),c.e(6).then(function(){var d=[c("./public/javascripts/module/LoginModule.js")];(function(c){c.controller.submitNewsletterEmail(a,b,f)}).apply(null,d)}).catch(c.oe)}};return m}.apply(b,d),!(void 0!==e&&(a.exports=e))},"./target/scala-2.11/classes/public/javascripts/templates/closure/no-i18n/tiger/components/newsletter/subscriptionButton.js":function(a,b,c){var d,e;d=[c("./public/javascripts/tiger.js"),c("./public/javascripts/mantle.js"),c("./public/javascripts/lib/amd-wrapped/soy/goog.js"),c("./public/javascripts/lib/amd-wrapped/soy/soy.js"),c("./public/javascripts/lib/amd-wrapped/soy/soydata.js")],e=function(a,b,c,d,e){if("undefined"==typeof a)var a={};"undefined"==typeof a.components&&(a.components={}),"undefined"==typeof a.components.newsletter&&(a.components.newsletter={}),a.components.newsletter.subscribeButton=function(b,c,d){var f="",g="Want "+b.blogName+"’s email newsletter?",h=g,i="Subscribe",j=i,i="Subscribe",k=i;return f+='<div class="newsletter-subscribe"><div class="newsletter-subscribe__copy">'+h+'</div><div class="newsletter-subscribe__cta"><button class="button hide-for-xlarge-up primary js_newsletter-subscribe">'+j+'</button><button class="button small show-for-xlarge-up primary js_newsletter-subscribe">'+k+'</button></div><div class="newsletter-subscribe__close js_close-subscribe">'+a.icons.essential.closeSmall(null,null,d)+"</div></div>",e.markUnsanitizedText(f)},c.DEBUG&&(a.components.newsletter.subscribeButton.soyTemplateName="tiger.components.newsletter.subscribeButton"),a.components.newsletter.subscribeButtonEmail=function(b,c,d){var f="",g="Want "+b.blogName+"’s email newsletter?",h=g,i="Subscribe",j=i;return f+='<div class="newsletter-subscribe newsletter-subscribe--email"><div class="newsletter-subscribe__copy">'+h+'</div><div class="newsletter-subscribe__cta">'+a.components.newsletter.emailField(b,null,d)+'<button class="button small primary js_submit">'+j+'</button></div><div class="newsletter-subscribe__close js_close-subscribe">'+a.icons.essential.closeSmall(null,null,d)+"</div></div>",e.markUnsanitizedText(f)},c.DEBUG&&(a.components.newsletter.subscribeButtonEmail.soyTemplateName="tiger.components.newsletter.subscribeButtonEmail"),a.components.newsletter.unsubscribe=function(a,b,c){return e.markUnsanitizedText('<a href="/unsubscribe">Unsubscribe from '+a.blogName+"’s Newsletter</a>")},c.DEBUG&&(a.components.newsletter.unsubscribe.soyTemplateName="tiger.components.newsletter.unsubscribe")}.apply(b,d),!(void 0!==e&&(a.exports=e))}});
//# sourceMappingURL=15.18a6ce3638c2ab51b4d3.en-US.js.map